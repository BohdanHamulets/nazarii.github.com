<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Python | Nazarii Gudzovatyi]]></title>
  <link href="http://Nazarii.github.io/blog/categories/python/atom.xml" rel="self"/>
  <link href="http://Nazarii.github.io/"/>
  <updated>2013-06-29T22:09:49+03:00</updated>
  <id>http://Nazarii.github.io/</id>
  <author>
    <name><![CDATA[Nazarii]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Calculating working days with python.]]></title>
    <link href="http://Nazarii.github.io/blog/2013/06/29/calculating-working-days-with-python/"/>
    <updated>2013-06-29T21:15:00+03:00</updated>
    <id>http://Nazarii.github.io/blog/2013/06/29/calculating-working-days-with-python</id>
    <content type="html"><![CDATA[<p>So the specification is following:
{% blockquote %}
We need to calculate number of working days between two dates &ndash; it mean&rsquo;s we need to calculate all days excluding Saturday and Sunday. If the function is running after 6:00 pm this working day need to be also excluded.
{% endblockquote %}</p>

<!-- more -->


<p>After some googling I&rsquo;ve found this task could be resolved using rrule module.
Be sure you have <a href="http://labix.org/python-dateutil">dateutil</a> library installed to use this example.
{% codeblock sublime-text lang:python%}
import time
from dateutil import rrule</p>

<p>def get_working_days(date_start_obj, date_end_obj):</p>

<pre><code>weekdays = rrule.rrule(rrule.DAILY, byweekday=range(0, 5), dtstart=date_start_obj, until=date_end_obj)
weekdays = len(list(weekdays))
if int(time.strftime('%H')) &gt;= 18:
    weekdays -= 1
return weekdays
</code></pre>

<p>{% endcodeblock %}
Here byweekday parameter is a list of days of week we want to caculate, ti&rsquo;s elements can be integers (Monday is 0, Tuesday is 1 etc) or rrule objects &ndash; rrule.MO, rrule.TU etc. Other usefull methods for date (e.g. full weeks) calculations could be found <a href="http://labix.org/python-dateutil">here</a>.</p>

<p>Suppose we need to calculate days from 1-01-2013 until 28-07-2013.
Our code will be:
{% codeblock sublime-text lang:python%}
from datetime import date</p>

<p>date_start_obj = date(2013, 1, 1)
date_end_obj = date(2013, 7, 18)
print get_working_days(date_start_obj, date_end_obj):
{% endcodeblock %}
The output wil be: <strong>142</strong> (Calculate yourself if don&rsquo;t trust me).</p>
]]></content>
  </entry>
  
</feed>
